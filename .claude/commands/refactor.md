Refactor code for better quality:
1. Identify code smells and anti-patterns
2. Extract reusable functions/components
3. Improve type safety
4. Enhance readability and maintainability
5. Ensure tests still pass
